<agent_config>
<syscheck>
    <!-- General syscheck behavior for all agents -->
    <frequency>3600</frequency>
    <scan_on_start>yes</scan_on_start>
    <auto_ignore>no</auto_ignore>
    <alert_new_files>yes</alert_new_files>
    <skip_nfs>yes</skip_nfs>
    <disabled>no</disabled>
</syscheck>
</agent_config>
<agent_config os="windows">
<!-- Sysmon logs -->
<localfile>
    <location>Microsoft-Windows-Sysmon/Operational</location>
    <log_format>eventchannel</log_format>
</localfile>
<!-- Active response log on Windows agent -->
<localfile>
    <location>C:\Program Files (x86)\ossec-agent\active-response\active-responses.log</location>
    <log_format>syslog</log_format>
</localfile>
<syscheck>
    <!-- Monitor user profile directories in real time -->
    <directories check_all="yes" realtime="yes">C:\Users\**</directories>
    <!-- Ignore BUILT-In accounts -->
    <ignore>C:\Users\All Users\*</ignore>
    <ignore>C:\Users\Default\*</ignore>
    <ignore>C:\Users\Default User\*</ignore>
    <ignore>C:\Users\Public\*</ignore>
    <ignore>C:\Users\WDAGUtilityAccount\*</ignore>
    <ignore>C:\Users\Administrator\*</ignore>
    <!-- Ignore Appdata -->
    <ignore type="sregex">appdata</ignore>
</syscheck>
</agent_config>
<!-- Linux-specific configuration -->
<agent_config os="linux">
<!-- Track active response actions executed on the Linux agent -->
<localfile>
    <location>/var/ossec/logs/active-responses.log</location>
    <log_format>syslog</log_format>
</localfile>
<syscheck>
    <!-- Monitor user home directories in real time -->
    <directories check_all="yes" realtime="yes">/home/**</directories>
    <directories check_all="yes" realtime="yes">/root/**</directories>
    <!-- Ignore common cache, temp, and user config paths to reduce false positives -->
    <ignore type="sregex">/.cache/</ignore>
    <ignore type="sregex">/.cache</ignore>
    <ignore type="sregex">/.tmp/</ignore>
    <ignore type="sregex">/.bash_history</ignore>
    <ignore type="sregex">/.bash_logout</ignore>
    <ignore type="sregex">/snap/</ignore>
    <ignore type="sregex">/.config/</ignore>
    <ignore type="sregex">/.gnupg/</ignore>
    <ignore type="sregex">/.local/</ignore>
</syscheck>
</agent_config>
